<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arduino Project</title>
    <!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/socket.io.js'></script> -->
    <!-- <link rel="stylesheet" media="screen and (max-device-width: 540px)" href="phone.css"> -->
    <script src="https://kit.fontawesome.com/f6dcf461c1.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gauge.js/1.3.7/gauge.min.js"
        integrity="sha512-J0d1VfdfTSDoDPEsahCtf2nC+groXdWkuQFyJjS+s3CpKj63X9Hf3pMEJtjIJt/ODh0QwTRx2/OioL+9fMoqSA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Hammersmith+One&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Roboto+Condensed&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Jomhuria&display=swap');

        body {
            background-color: #dcbe0c;
            /* overflow: hidden; */
        }

        body::-webkit-scrollbar {
            display: none;
        }

        #header {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 80px;
            background-color: rosybrown;

            display: flex;
            justify-content: center;
            align-items: center;
            /* z-index: 5; */
            /* background: url("ongc2.jpg");
            background-repeat: no-repeat;
            background-size: 300px 100px; */
            /* background-image: url("ongc2.jpg");
            background-size: cover;
            background-attachment: fixed; */
            /* height: 20vh; */
        }

        /* #header img {
            position: absolute;
            top: 0px;
            width: 100%;
            height: 585px;
            background-size: cover;
        } */

        #head {
            /* position: absolute;
            display: block;
            top: -23px;
            left: 36vw; */
            font-size: 50px;
            font-family: 'Hammersmith One', sans-serif;
        }

        @media screen and (max-width: 540px) {
            #head {
                font-size: 31px !important;
            }
        }

        #head2 {
            /* display: flex;
            justify-content: center;
            align-items: center; */
            margin-top: 133px;
            width: 89vw;
            height: 88px;
            display: inline-block;
            /* border: 2px solid red; */
        }

        #head22 {
            position: relative;
            top: 46px;
            left: 18vw;
            font-size: 31px;
            display: inline-block;
            font-family: 'Roboto Condensed', sans-serif;

        }

        @media screen and (max-width: 640px) {
            #head22 {
                left: 1vw !important;
            }
        }

        #mainContainer {
            position: absolute;
            top: 230px;
            left: 0px;

            width: 100vw;
            height: 789px;
            /* border: 2px solid green; */
        }

        #container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 904px;
            /* border: 2px solid red; */
        }

        @media screen and (max-width: 349px) {
            #container {
                height: 979px !important;
            }
        }

        #boxes {
            /* position: absolute;
            top: 220px;
            left: 25vw; */
            display: flex;
            flex-direction: column;
            width: 936px;
            height: 900px;
            /* border: 2px solid red; */
            font-size: 38px;


            background: rgba(248, 231, 28, 0.25);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.18);
            font-family: 'Roboto Condensed', sans-serif;
        }

        @media screen and (max-width: 540px) {
            #boxes {
                font-size: 26px !important;
            }
        }

        #boxes iframe {
            position: absolute;
            top: 542px;
            left: 5px;
            width: 96%;
        }

        #box1 {
            position: absolute;
            /* margin-bottom: 117px; */
            top: 70px;
            left: 34px;
            display: inline-block;
        }

        #box2 {
            position: absolute;
            top: 181px;
            left: 34px;
            display: inline-block;
        }

        #warningBox {
            position: absolute;
            top: 219px;
            left: 396px;
            color: red;
            font-size: 34px;
            animation: ani 1s linear infinite;
            opacity: 1;
            display: none;
        }

        @keyframes ani {
            0% {
                opacity: 0;
            }

            100% {
                opacity: 1;
            }
        }

        @media screen and (max-width: 540px) {
            #warningBox {
                top: 209px;
                left: 284px;
            }
        }

        @media screen and (max-width: 406px) {
            #warningBox {
                top: 262px;
                left: 192px;
            }
        }

        @media screen and (max-width: 312px) {
            #warningBox {
                left: 63vw;
                font-size: 28px;
            }
        }

        #dt {
            position: absolute;
            top: 851px;
            left: 27vw;
            color: rgb(24, 4, 207);
            animation: ani2 1s linear infinite;
            font-weight: 900;
        }

        @keyframes ani2 {
            0% {
                color: red;
            }

            100% {
                color: rgb(24, 4, 207);
            }
        }

        @media screen and (max-width: 540px) {
            #dt {
                left: 4vw;
            }
        }

        /* #sample {
            position: absolute;
            top: 234px;
            left: 56px;
            background-color: red;
            width: 300px;
            height: 300px;
            border-radius: 22px;

        } */


        /* Meter */



        #boxmeter {
            position: absolute;
            top: 123px;
            left: 234px;
            width: 238px;
            height: 236px;
            border: 2px solid red;
        }

        #meter {
            position: absolute;
            top: 94px;
            left: 117px;
            width: 2px;
            height: 74px;
            background-color: red;
            border-top-left-radius: 50%;
            border-top-right-radius: 50%;
            /* transform: rotate(20deg); */
            /* border: 2px solid green; */
        }

        #boxmeter img {
            position: absolute;
            width: 232px;
            height: 232px;
            border: 2px solid yellow;
        }

        #mainDisplayBox {
            border: 2px solid red;
            width: 90%;
            height: 139px;
            position: absolute;
            top: 292px;
            left: 14px;

            background: rgba(248, 231, 28, 0.25);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.18);
        }

        #display {
            position: absolute;
            top: 8px;
            left: 7px;

        }

        #displayBox {
            position: absolute;
            top: 61px;
            left: 0px;
            font-size: 23px;
            background-color: #9d9393;
            width: 100%;
            height: 57px;
        }

        #warningMessage {
            position: absolute;
            top: 17px;
            left: 12px;
            color: red;
            animation: ani3 1s linear infinite;
        }

        @keyframes ani3 {
            0% {
                opacity: 0;
            }

            100% {
                opacity: 1;
            }
        }

        #mainBuzzerBox {
            position: absolute;
            top: 447px;
            left: 26px;
            width: 197px;
            height: 56px;
            border: 2px solid black;
            border-radius: 34px;
            background: rgba(248, 231, 28, 0.25);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.18);

        }

        #buzz {
            position: absolute;
            top: 3px;
            font-size: 47px;
            font-family: 'Jomhuria', cursive;
        }

        #buzzer {
            position: absolute;
            top: 5px;
            left: 14px;
        }

        #Dot {
            position: absolute;
            top: -109px;
            font-size: 146px;
            left: 131px;
            color: rgb(21, 245, 13);
            display: inline-block;
            animation: glow 0.5s ease-in-out infinite alternate;
            /* box-shadow: 10px 9px 10px 20px; */
            /* animation: ani4 1s linear infinite; */
        }


        @keyframes glow {
            0% {
                text-shadow: 0 0 10px rgb(173, 240, 160), 0 0 20px rgb(45, 243, 95), 0 0 30px #00e626, 0 0 40px #00e632, 0 0 50px #00e61f, 0 0 60px #1be600, 0 0 70px #00e613;
            }

            100% {
                text-shadow: 0 0 20px #fff, 0 0 30px #71ff4d, 0 0 40px #4dff65, 0 0 50px #71ff4d, 0 0 60px #4dff4d, 0 0 70px #53ff4d, 0 0 80px #4dff5c;
            }
        }

        .Dot2 {
            position: absolute;
            top: -109px;
            font-size: 146px;
            left: 131px;
            color: rgb(245, 13, 13) !important;
            display: inline-block;
            animation: glow2 0.5s ease-in-out infinite alternate !important;
        }

        @keyframes glow2 {
            0% {
                text-shadow: 0 0 10px rgb(236, 128, 128), 0 0 20px rgb(243, 45, 45), 0 0 30px #f11d15, 0 0 40px #ec1a1a, 0 0 50px #f71d1d, 0 0 60px #ff1010, 0 0 70px #ee1818 !important;
            }

            100% {
                text-shadow: 0 0 20px rgb(233, 110, 110), 0 0 30px #ff3030, 0 0 40px #f32a2a, 0 0 50px #e41d1d, 0 0 60px #f80a0a, 0 0 70px #fb0000, 0 0 80px #ee0b0b !important;
            }
        }

        .chart {
            position: absolute;
            top: 73px;
            left: 504px;
            background: rgba(248, 231, 28, 0.25);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.18);
        }

        @media screen and (max-width: 816px) {
            .chart {
                top: 265px;
                left: 3.8%;
            }
            #mainDisplayBox{
                top: 455px;
            }
            #mainBuzzerBox {
                top: 620px;
            }
            #boxes iframe {
                top: 707px;
            }
            #dt{
                top: 1027px;
            }
        }
        @media screen and (max-width: 326px) {
            .chart {
                left: 0.8%;
            }
        }

        #ppmLevel {
            position: absolute;
            left: 5px;
            font-size: 24px;
            font-family: 'Jomhuria', cursive;
        }
    </style>
</head>

<body>
    <header id="header">
        <h1 id="head">System Dashboard</h1>
        <!-- <img src="./static/files/ongc2.jpg" alt=""> -->
    </header>
    <div id="head2">
        <div id="head22">1. Monitoring Gas Sensor</div>

    </div>
    <div id="mainContainer">
        <div id="container">
            <div id="boxes">
                <div id="box1">Safe Value: &nbsp; &nbsp; &nbsp; <span id="thershold">105 &nbsp;ppm</span></div>
                <div id="box2">Current Value: &nbsp; &nbsp;<span id="warnValue">error!!</span><span
                        id="unit">&nbsp;ppm</span>
                </div>
                <div class="chart">
                    <div id="ppmLevel">PPM Level Indicator</div>
                    <canvas id="gauge"></canvas>

                </div>
                <div id="mainDisplayBox">
                    <div id="display">Display</div>
                    <div id="displayBox">
                        <span id="warningMessage">All Ok!</span>
                    </div>
                </div>
                <div id="mainBuzzerBox">
                    <div id="buzzer"> <span id="buzz"> Buzzer </span><span id="Dot">.</span></div>
                </div>
                <!-- <div id="warningBox">Warning!</div> -->
                <iframe width="450" height="260" style="border: 1px solid #188fc7;"
                    src="https://thingspeak.com/channels/1422086/charts/1?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=30&type=line&xaxis=Time"></iframe>
                <!-- <iframe width="450" height="260" style="border: 1px solid #188fc7;" src="https://thingspeak.com/channels/1422086/charts/1?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=line&xaxis=Time"></iframe> -->
                <!-- <iframe width="450" height="260" style="border: 1px solid #188fc7;" src="https://thingspeak.com/channels/1422086/charts/1?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=line&update=15"></iframe> -->
            </div>
            <div id="dt">Last update at = error!!</div>
        </div>
    </div>

    <!-- <canvas id="demo"></canvas> -->

    <!-- <div id="boxmeter">
        <img src="./static/me.jpg" alt="">
        <div id="meter"></div>
    </div> -->

    <!-- <div id="warningBox">Warning!</div> -->

    <!-- <div id="sample"></div> -->


    <!-- <script>
         console.log('https://api.thingspeak.com/channels/1422086/feeds/last.json')
     </script> -->
    <script>

        var api_url = 'https://api.thingspeak.com/channels/1422086/feeds/last.json?timezone=Asia/Kolkata'


        async function getValue() {
            var response = await fetch(api_url);
            var data = await response.json();
            var { field1 } = data;

            if (field1 > 105) {
                document.getElementById('Dot').style.color = 'red';
                document.getElementById('Dot').classList.add("Dot2");
                // document.getElementById("Dot").id = "Dot2";
                document.getElementById('warningMessage').style.color = 'red';
                document.getElementById('warningMessage').innerHTML = 'Warning! Gas Leak Detected';
                document.getElementById('warnValue').color = 'red';
            }
            else {
                document.getElementById('Dot').style.color = 'green';
                document.getElementById('Dot').classList.remove("Dot2");
                document.getElementById('warningMessage').style.color = 'green';
                document.getElementById('warningMessage').innerHTML = 'All Ok!';
                document.getElementById('warnValue').color = 'green';
                // document.getElementById("Dot").id = "Dot";
            }
            document.getElementById('warnValue').innerHTML = field1;
            var { created_at } = data;
            // var degree = field1;
            document.getElementById('dt').innerHTML = "Last Update at : " + created_at;
            // document.getElementById('meter').style.transform = rotate(field1 + 'deg');
            console.log(field1)
            console.log(created_at)
            let opts = {
                angle: 0, // The span of the gauge arc
                lineWidth: 0.44, // The line thickness
                radiusScale: 0.83, // Relative radius
                pointer: {
                    length: 0.6, // // Relative to gauge radius
                    strokeWidth: 0.035, // The thickness
                    color: '#000000' // Fill color
                },
                staticLabels: {
                    font: "10px sans-serif",
                    labels: [0, 50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    fractionDigits: 0
                },
                staticZones: [
                    { strokeStyle: "#1D9C09", min: 0, max: 50 },
                    { strokeStyle: "#30B32D", min: 50, max: 105 },
                    { strokeStyle: "#E88E61", min: 105, max: 150 },
                    { strokeStyle: "#F06651", min: 150, max: 200 },
                    { strokeStyle: "#F05941", min: 200, max: 250 },
                    { strokeStyle: "#EB381C", min: 250, max: 300 },
                    { strokeStyle: "#EB381C", min: 300, max: 350 },
                    { strokeStyle: "#EB381C", min: 350, max: 400 },
                    { strokeStyle: "#EB381C", min: 400, max: 450 },
                    { strokeStyle: "#EB381C", min: 450, max: 500 }
                ],
                limitMax: false, // If false, max value increases automatically if value > maxValue
                limitMin: false, // If true, the min value of the gauge will be fixed
                colorStart: '#6FADCF', // Colors
                colorStop: '#8FC0DA', // just experiment with them
                strokeColor: '#E0E0E0', // to see which ones work best for you
                generateGradient: true,
                highDpiSupport: true // High resolution support
            }

            let target = document.querySelector('#gauge') // your canvas element

            let gaugeChart = new Gauge(target).setOptions(opts) // create sexy gauge!
            gaugeChart.maxValue = 500 // set max gauge value
            gaugeChart.setMinValue(0) // Prefer setter over F03E3Egauge.minValue = 0
            gaugeChart.animationSpeed = 32 // set animation speed (32 is default value)
            gaugeChart.set(field1) // set actual value
        }

        getValue();
        setInterval(getValue, 10000);




        // var socket = io();

        // socket.on('data', function (data) {

        //     if (data > 105) {
        //         document.getElementById('warningBox').style.display = 'revert';
        //     }
        //     else {
        //         document.getElementById('warningBox').style.display = 'none';
        //     }
        //     console.log(data);
        //     document.getElementById('warnValue').innerHTML = data;
        //     document.getElementById('sample').style.top = data + "px";

        // });


    </script>




    <!-- <canvas id="demo"></canvas> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/gauge.js/1.3.5/gauge.min.js"></script> -->
    <!-- <script src="gauge.min.js"></script> -->
    <!-- <script>let opts = {
    angle: 0, // The span of the gauge arc
    lineWidth: 0.44, // The line thickness
    radiusScale: 0.83, // Relative radius
    pointer: {
      length: 0.6, // // Relative to gauge radius
      strokeWidth: 0.035, // The thickness
      color: '#000000' // Fill color
    },
    limitMax: false, // If false, max value increases automatically if value > maxValue
    limitMin: false, // If true, the min value of the gauge will be fixed
    colorStart: '#6FADCF', // Colors
    colorStop: '#8FC0DA', // just experiment with them
    strokeColor: '#E0E0E0', // to see which ones work best for you
    generateGradient: true,
    highDpiSupport: true // High resolution support
  }
  
  let target = document.querySelector('#gauge') // your canvas element
  
  let gaugeChart = new Gauge(target).setOptions(opts) // create sexy gauge!
  gaugeChart.maxValue = 3000 // set max gauge value
  gaugeChart.setMinValue(0) // Prefer setter over gauge.minValue = 0
  gaugeChart.animationSpeed = 32 // set animation speed (32 is default value)
  gaugeChart.set(field1) // set actual value</script> -->
    <!-- <script src="js/main.js"></script> -->

</body>

</html>